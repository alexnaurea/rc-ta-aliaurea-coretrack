import { StepLogger } from '../../../../../core/logger/step-logger';
import { PageHelper } from '../../../../components/html/page-helper';
import { HomePage1Helper } from '../../../../page-objects/pages/home-page/home-page1.helper';
import { LoginPageHelper } from '../../../../page-objects/pages/login-page/login-page.helper';
import { CampaignsConstant } from '../../../../page-objects/pages/marketing/campaigns/campaigns.constants';
import { CampaignsPageHelper } from '../../../../page-objects/pages/marketing/campaigns/campaigns.helper';
import { SuiteNames } from '../../../helpers/suite-names';

describe(SuiteNames.regressionSuite, () => {
    let loginPageHelper: LoginPageHelper;

    beforeAll(async () => {
        loginPageHelper = LoginPageHelper.getInstance();
        await PageHelper.maximiseBrowser();
    });

    beforeEach(async () => {
        await PageHelper.restartBrowser();
        await loginPageHelper.goTo();
        await LoginPageHelper.loginAsAdmin();
    });

    // Jira References - COTRAC-4577
    it('Verify if user shall be able to Refresh the page properly - [22416677]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:30 GMT

        StepLogger.caseId = 22416677;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List
        -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on "Refresh" button');
        await CampaignsPageHelper.clickOnRefreshButton();
        StepLogger.verification('Should refresh the page properly.');
        // This actions is not verifiable since it doesn't apply any change in the screen
    });

    // Jira References - COTRAC-4584
    it('Verify if user shall be able to Collapse the sections properly - [22416694]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:31 GMT

        StepLogger.caseId = 22416694;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List
        -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Select the "Active" option in the filter.');
        await CampaignsPageHelper.selectGroupingOption(CampaignsConstant.groupingOptions.active);
        StepLogger.verification('Should display the grid classified by Active sections.');
        await CampaignsPageHelper.verifyRecordsAreGrouped(CampaignsConstant.groupingOptions.active);

        StepLogger.stepId(4);
        StepLogger.step('Click on "-" button.');
        await CampaignsPageHelper.clickOnGroupingIcon(CampaignsConstant.groupingOptions.active);
        StepLogger.verification('Should collapse the section properly.');
        await CampaignsPageHelper.verifyRecordsAreCollapsed(CampaignsConstant.groupingOptions.active);
    });

    // Jira References - COTRAC-4595
    it('Verify if user shall be able to sort the grid list by Active column - [22416728]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:31 GMT

        StepLogger.caseId = 22416728;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List
        -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on Active column.');
        await CampaignsPageHelper.clickOnActiveColumn();
        StepLogger.verification('Should sort the grid data by Active column properly.');
        await CampaignsPageHelper.verifyRecordsSortedAsc(CampaignsConstant.elementNames.marketingColumns.active);
    });

    // Jira References - COTRAC-4592
    it('Verify if user shall be able to sort the grid list by Campaign column - [22416725]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:32 GMT

        StepLogger.caseId = 22416725;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List
        -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on Campaign column.');
        await CampaignsPageHelper.clickOnCampaignColumn();
        StepLogger.verification('Should sort the grid data by Campaign properly.');
        await CampaignsPageHelper.verifyRecordsSortedAsc(CampaignsConstant.elementNames.marketingColumns.campaign);
    });

    // Jira References - COTRAC-4593
    it('Verify if user shall be able to sort the grid list by Type column - [22416726]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:32 GMT

        StepLogger.caseId = 22416726;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List
        -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on Type column.');
        await CampaignsPageHelper.clickOnTypeColumn();
        StepLogger.verification('Should sort the grid data by Type properly.');
        await CampaignsPageHelper.verifyRecordsSortedAsc(CampaignsConstant.elementNames.marketingColumns.type);
    });

    // Jira References - COTRAC-4579
    it('Verify if user shall be able to filter the grid list by Active option - [22416680]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:32 GMT

        StepLogger.caseId = 22416680;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List
        -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Select the Active option in the filter.');
        await CampaignsPageHelper.selectGroupingOption(CampaignsConstant.groupingOptions.active);
        StepLogger.verification('Should display campaigns type as "Active" in the grid classified in sections.');
        await CampaignsPageHelper.verifyRecordsAreGrouped(CampaignsConstant.groupingOptions.active);
    });

    // Jira References - COTRAC-4585
    it('Verify if user shall be able to Expand the sections properly - [22416695]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:32 GMT

        StepLogger.caseId = 22416695;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List
        -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Select "Active" option in the filter.');
        await CampaignsPageHelper.selectGroupingOption(CampaignsConstant.groupingOptions.active);
        StepLogger.verification('Should display the data in the grid by Active sections.');
        await CampaignsPageHelper.verifyRecordsAreGrouped(CampaignsConstant.groupingOptions.active);

        StepLogger.stepId(4);
        StepLogger.step('Click on "+" button to expand the sections.');
        await CampaignsPageHelper.clickOnGroupingIconToCollapse(CampaignsConstant.groupingOptions.active);
        await CampaignsPageHelper.clickOnGroupingIcon(CampaignsConstant.groupingOptions.active);
        StepLogger.verification('Should expand the sections properly.');
        await CampaignsPageHelper.verifyRecordsAreExpanded(CampaignsConstant.groupingOptions.active);
    });

    // Jira References - COTRAC-4586
    it('Verify if the New Campaign screen is displaying properly - [22416703]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:32 GMT

        StepLogger.caseId = 22416703;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List
        -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on New button.');
        await CampaignsPageHelper.clickOnAddCampaignButton();
        StepLogger.verification('Should open the New Campaign scree in a new tab properly.');
        await CampaignsPageHelper.verifyNewCampaignPageDisplayed(false);

        StepLogger.stepId(4);
        StepLogger.step('Check the fields in the New Campaign screen.');
        StepLogger.verification(`Should display the fields:
        -NAME1:
        -TYPE:
        -COST:
        -DESCRIPTION:`);
        await CampaignsPageHelper.verifyNewCampaignFields();
    });

    // Jira References - COTRAC-4587
    it('Verify if user shall be able to the Mandatory fields properly - [22416706]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:32 GMT

        StepLogger.caseId = 22416706;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List
        -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on New button.');
        await CampaignsPageHelper.clickOnAddCampaignButton();
        StepLogger.verification('Should open the New Campaign scree in a new tab properly.');
        await CampaignsPageHelper.verifyNewCampaignPageDisplayed(false);

        StepLogger.stepId(4);
        StepLogger.step('Check the mandatory fields in the New Campaign screen.');
        StepLogger.verification(`Should display the mandatory fields:
        -NAME1:
        -TYPE:
        -DESCRIPTION:`);
        await CampaignsPageHelper.verifyNewCampaignMandatoryFields();
    });

    // Jira References - COTRAC-4589
    it('Verify if additional fields is displaying properly after click on Save button - [22416719]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:31 GMT

        StepLogger.caseId = 22416719;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List
        -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on Create New Campaign button.');
        await CampaignsPageHelper.clickOnAddCampaignButton();
        StepLogger.verification('Should open the Create New Marketing Campaign screen properly.');
        await CampaignsPageHelper.verifyNewCampaignPageDisplayed(false);

        StepLogger.stepId(4);
        StepLogger.step('Fill all mandatory fields and click on Save button.');
        await CampaignsPageHelper.fillInNewCampaignMandatoryFields();
        await CampaignsPageHelper.clickOnSaveButton();
        StepLogger.verification('Should save the user data properly and show the new fields list.');
        await CampaignsPageHelper.verifyNewCampaignHasBeenSaved();

        StepLogger.stepId(5);
        StepLogger.step('Check the new fields on screen.');
        StepLogger.verification(`The screen should have new fields list:
        -Digital Mailer
        -Lauched On: + Launch button
        -Total number of activities/contacts targeted in this campaign:
        -Number of users included in campaign:
        -Number of pipelines and events included in campaign:
        -Distribute pipelines and events to users or queues?
        -Number of products recommended in this campaign:
        -Show recommended products to all users, or only to distribution list?
        -Is campaign currently active?
        -Refresh distribution list automatically?
        -Refresh using:`);
        await CampaignsPageHelper.verifyNewFieldsAdded();
    });

    // Jira References - COTRAC-4578
    it('Verify if user shall be able to Create a new Marketing Campaigns type as Contact - [22416678]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:32 GMT

        StepLogger.caseId = 22416678;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List, -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on "Create" new marketing campaign button.');
        await CampaignsPageHelper.clickOnAddCampaignButton();
        StepLogger.verification('Should open the the page to create a new marketing campaign in a new tab.');
        await CampaignsPageHelper.verifyNewCampaignPageDisplayed(false);

        StepLogger.stepId(4);
        StepLogger.step(`Fill all mandatory fields properly and click on "Save" button.
        -Name1:
        -Type:
        -Description`);
        const name = await CampaignsPageHelper.fillInNewCampaignMandatoryFields();
        await CampaignsPageHelper.clickOnSaveButton();
        StepLogger.verification('Should save the new campaign properly and show the new fields to user.');
        await CampaignsPageHelper.verifyNewCampaignHasBeenSaved();
        await CampaignsPageHelper.verifyNewFieldsAdded();

        StepLogger.stepId(5);
        StepLogger.step('Click on close button.');
        await CampaignsPageHelper.clickOnCloseButton();
        StepLogger.verification('Should display a popup confirmation.');
        await CampaignsPageHelper.verifyWarningPopupDisplayed();

        StepLogger.stepId(6);
        StepLogger.step('Click on OK button.');
        await CampaignsPageHelper.clickOkButtonOnWarningPopup();
        StepLogger.verification('Should close the tab and show the new campaign created in the grid list.');
        await CampaignsPageHelper.verifyWarningPopupClosed();
        await CampaignsPageHelper.verifyCreateCampaign(name);
    });

    // Jira References - COTRAC-4590
    it('Verify if the additional tabs is displaying properly after click on Save button - [22416721]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:31 GMT

        StepLogger.caseId = 22416721;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List
        -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on Create New Campaign button.');
        await CampaignsPageHelper.clickOnAddCampaignButton();
        StepLogger.verification('Should open the Create New Marketing Campaign screen properly.');
        await CampaignsPageHelper.verifyNewCampaignPageDisplayed(false);

        StepLogger.stepId(4);
        StepLogger.step('Fill all mandatory fields and click on Save button.');
        await CampaignsPageHelper.fillInNewCampaignMandatoryFields();
        await CampaignsPageHelper.clickOnSaveButton();
        StepLogger.verification('Should save the user data properly and show the new fields list.');
        await CampaignsPageHelper.verifyNewCampaignHasBeenSaved();
        await CampaignsPageHelper.verifyNewFieldsAdded();

        StepLogger.stepId(5);
        StepLogger.step('Check the new tabs on screen.');
        StepLogger.verification(`Should display the new tabs properly.
        -Overview
        -Distribution
        -Campaign Items
        -Notes
        -Attachments
        -Campaign Stats`);
        await CampaignsPageHelper.verifyNewCampaignPageTabsAdded();
    });

    // Jira References - COTRAC-4588
    it('Verify if COST field allows only numbers - [22416714]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:32 GMT

        StepLogger.caseId = 22416714;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List, -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on Create New Campaign button.');
        await CampaignsPageHelper.clickOnAddCampaignButton();
        StepLogger.verification('Should open the Create New Marketing Campaign screen properly.');
        await CampaignsPageHelper.verifyNewCampaignPageDisplayed(false);

        StepLogger.stepId(4);
        StepLogger.step('Insert characters in the COST field.');
        await CampaignsPageHelper.typeCostStringValue(CampaignsConstant.testData.textValue);
        StepLogger.verification('Should display a error message: "Please enter a valid number."');
        await CampaignsPageHelper.clickOnNameField();
        await CampaignsPageHelper.verifyValidationMessageDisplayed(CampaignsConstant.messages.pleaseEnterAValidNumber);
    });

    // Jira References - COTRAC-4597
    it('Verify if user shall be able to Create a new Marketing Campaign type as Activity - [22416708]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 14:48:32 GMT

        StepLogger.caseId = 22416708;
        StepLogger.stepId(1);
        StepLogger.step('Click on Marketing button menu.');
        await HomePage1Helper.clickOnMarketingMenu();
        StepLogger.verification(`Should expand and the menu and should the options:
        -Marketing List, -Campaigns`);
        await HomePage1Helper.verifyMarketingSubmenu();

        StepLogger.stepId(2);
        StepLogger.step('Click on Campaigns button.');
        await HomePage1Helper.clickOnCampaignsOption();
        StepLogger.verification('Should display the Marketing Campaigns screen properly.');
        await CampaignsPageHelper.verifyMarketingCampaignsPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on New button.');
        await CampaignsPageHelper.clickOnAddCampaignButton();
        StepLogger.verification('Should open the New Campaign scree in a new tab properly.');
        await CampaignsPageHelper.verifyNewCampaignPageDisplayed(false);

        StepLogger.stepId(4);
        StepLogger.step('Select TYPE field as "Activity"');
        await CampaignsPageHelper.selectType(CampaignsConstant.testData.activity);
        StepLogger.verification('The Type option should be "Activity".');
        await CampaignsPageHelper.verifySelectedType(CampaignsConstant.testData.activity);

        StepLogger.stepId(5);
        StepLogger.step('Fill all mandatory fields and click on "Save" button.');
        const name = await CampaignsPageHelper.typeNameAndDescription();
        await CampaignsPageHelper.clickOnSaveButton();
        StepLogger.verification('Should create a new Marketing Campaign type as Activity properly.');
        await CampaignsPageHelper.verifyCreateCampaign(name);
    });
});
