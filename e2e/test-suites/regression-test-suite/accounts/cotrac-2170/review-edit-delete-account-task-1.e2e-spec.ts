import { StepLogger } from '../../../../../core/logger/step-logger';
import { PageHelper } from '../../../../components/html/page-helper';
import { AccountsOnePageHelper } from '../../../../page-objects/pages/accounts/accounts-one.helper';
import { LoginPageHelper } from '../../../../page-objects/pages/login-page/login-page.helper';
import { SuiteNames } from '../../../helpers/suite-names';

describe(SuiteNames.regressionSuite, () => {
    let loginPageHelper: LoginPageHelper;

    beforeAll(async () => {
        loginPageHelper = LoginPageHelper.getInstance();
        await PageHelper.maximiseBrowser();
    });

    beforeEach(async () => {
        await PageHelper.restartBrowser();
        await loginPageHelper.goTo();
    });

    // Jira References - COTRAC-2170
    it('Verify that the User can view History page for a selected Task - [22946659]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 13:59:27 GMT

        StepLogger.caseId = 22946659;
        const uniqueText = await PageHelper.getUniqueId();

        StepLogger.preCondition('Log in and navigate to Production page and open an account ');
        await AccountsOnePageHelper.navigateAndCreatTask(uniqueText);

        StepLogger.stepId(1);
        StepLogger.step('Go to task tab from the left menu panel');
        await AccountsOnePageHelper.clickTasksTabInSidebar();
        StepLogger.verification('Tasks should be displayed in a grid view for the opened Account');
        await AccountsOnePageHelper.verifyTasksPageIsDisplayed();

        StepLogger.stepId(2);
        StepLogger.step('Click on edit icon before Task name for any Item in list');
        await AccountsOnePageHelper.clickEditTask(uniqueText);
        StepLogger.verification('Edit task page should be displayed for the selected task');
        await AccountsOnePageHelper.verifySubjectIsEntered(uniqueText);

        StepLogger.stepId(3);
        StepLogger.step('Click on the three dots at Top left corner of Edit Task page');
        await AccountsOnePageHelper.clickMenuButton();
        StepLogger.verification('Menu should be displayed with History and Delete options');
        await AccountsOnePageHelper.verifyMenuList();

        StepLogger.stepId(4);
        StepLogger.step('Click on History button');
        await AccountsOnePageHelper.clickHistory();
        StepLogger.verification('History page should be displayed for the selected task as below');
        await AccountsOnePageHelper.verifyHistoryWindow();
    });

    // Jira References - COTRAC-2170
    it('Verify the History page for a selected Account Task - [22946672]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 13:59:26 GMT

        StepLogger.caseId = 22946672;
        const uniqueText = await PageHelper.getUniqueId();

        StepLogger.preCondition('Log in and navigate to Production page and open an account ');
        await AccountsOnePageHelper.navigateAndCreatTask(uniqueText);

        StepLogger.stepId(1);
        StepLogger.step('Go to task tab from the left menu panel');
        await AccountsOnePageHelper.clickTasksTabInSidebar();
        StepLogger.verification('Tasks should be displayed in a grid view for the opened Account');
        await AccountsOnePageHelper.verifyTasksPageIsDisplayed();

        StepLogger.stepId(2);
        StepLogger.step('Click on edit icon before Task name for any Item in list');
        await AccountsOnePageHelper.clickEditTask(uniqueText);
        StepLogger.verification('Edit task page should be displayed for the selected task');
        await AccountsOnePageHelper.verifySubjectIsEntered(uniqueText);

        StepLogger.stepId(3);
        StepLogger.step('Click on the three dots at Top left corner of Edit Task page');
        await AccountsOnePageHelper.clickMenuButton();
        StepLogger.verification('Menu should be displayed with History and Delete options');
        await AccountsOnePageHelper.verifyMenuList();

        StepLogger.stepId(4);
        StepLogger.step('Click on History button');
        await AccountsOnePageHelper.clickHistory();
        StepLogger.verification('History page should be displayed for the selected task as below');
        await AccountsOnePageHelper.verifyHistoryWindow();

        StepLogger.stepId(5);
        StepLogger.step('Verify the Tabs in History page');
        StepLogger.verification('Following tabs should be displayed,Summary, Details');
        await AccountsOnePageHelper.verifyTaskHistoryTab();

        StepLogger.stepId(6);
        StepLogger.step('Verify the Summary page');
        StepLogger.verification(`Following fields should be displayed,
            Created - Created By - Last modified - Modified by`);
        await AccountsOnePageHelper.verifyHistoryField();

        StepLogger.stepId(7);
        StepLogger.step('Click the Close button');
        await AccountsOnePageHelper.clickHistoryClose();
        StepLogger.verification('User should be navigated back to Edit task page');
        await AccountsOnePageHelper.verifySubjectIsEntered(uniqueText);
    });

    // Jira References - COTRAC-2170
    it('Verify that the User can view History Details page for a selected Account Task - [22946676]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 13:59:28 GMT

        StepLogger.caseId = 22946676;
        const uniqueText =  await PageHelper.getUniqueId();

        StepLogger.preCondition('Log in and navigate to Production page and open an account ');
        await AccountsOnePageHelper.navigateAndCreatTask(uniqueText);

        StepLogger.stepId(1);
        StepLogger.step('Go to task tab from the left menu panel');
        await AccountsOnePageHelper.clickTasksTabInSidebar();
        StepLogger.verification('Tasks should be displayed in a grid view for the opened Account');
        await AccountsOnePageHelper.verifyTasksPageIsDisplayed();

        StepLogger.stepId(2);
        StepLogger.step('Click on edit icon before Task name for any Item in list');
        await AccountsOnePageHelper.clickEditTask(uniqueText);
        StepLogger.verification('Edit task page should be displayed for the selected task');
        await AccountsOnePageHelper.verifySubjectIsEntered(uniqueText);

        StepLogger.stepId(3);
        StepLogger.step('Click on the three dots at Top left corner of Edit Task page');
        await AccountsOnePageHelper.clickMenuButton();
        StepLogger.verification('Menu should be displayed with History and Delete options');
        await AccountsOnePageHelper.verifyMenuList();

        StepLogger.stepId(4);
        StepLogger.step('Click on History button');
        await AccountsOnePageHelper.clickHistory();
        StepLogger.verification('History page should be displayed for the selected task as below');
        await AccountsOnePageHelper.verifyHistoryWindow();

        StepLogger.stepId(5);
        StepLogger.step('Click on Details tab');
        await AccountsOnePageHelper.clickHistoryDetailsTab();
        StepLogger.verification('Details tab should get opened for the selected task and ' +
            'logs should be displayed according to the view selected');
        await AccountsOnePageHelper.verifyHistoryDetailsPanel();

        StepLogger.stepId(6);
        StepLogger.step('Verify the Details page view options from the drop down');
        StepLogger.verification(`Following view options should be available,
            Show log in read view
            Show log in list view`);
        await AccountsOnePageHelper.verifyDetailDropDownOption();

        StepLogger.stepId(7);
        StepLogger.step('Select "Show log in list view" option');
        await AccountsOnePageHelper.clickShowLogInListView();
        StepLogger.verification('Details page view should get changed and logs should be displayed according to the view selected');
        await AccountsOnePageHelper.verifyLogListView();

        StepLogger.stepId(8);
        StepLogger.step('Verify buttons displayed in History Details page');
        StepLogger.verification('Export to Word button should be available in top right of the page');
        await AccountsOnePageHelper.verifyDetailPanelButton();

        StepLogger.stepId(9);
        StepLogger.step('Click the Close button');
        await AccountsOnePageHelper.clickHistoryClose();
        StepLogger.verification('User should be navigated back to Edit task page');
        await AccountsOnePageHelper.verifySubjectIsEntered(uniqueText);
    });

    // Jira References - COTRAC-2170
    it('Verify that User can Cancel deletion of a selected Account Task - [22946682]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 13:59:27 GMT

        StepLogger.caseId = 22946682;
        const uniqueText = await PageHelper.getUniqueId();

        StepLogger.preCondition('Log in and navigate to Production page and open an account ');
        await AccountsOnePageHelper.navigateAndCreatTask(uniqueText);

        StepLogger.stepId(1);
        StepLogger.step('Go to task tab from the left menu panel');
        await AccountsOnePageHelper.clickTasksTabInSidebar();
        StepLogger.verification('Tasks should be displayed in a grid view for the opened Account');
        await AccountsOnePageHelper.verifyTasksPageIsDisplayed();

        StepLogger.stepId(2);
        StepLogger.step('Click on edit icon before Task name for any Item in list');
        await AccountsOnePageHelper.clickEditTask(uniqueText);
        StepLogger.verification('Edit task page should be displayed for the selected task');
        await AccountsOnePageHelper.verifySubjectIsEntered(uniqueText);

        StepLogger.stepId(3);
        StepLogger.step('Click on the three dots at Top left corner of Edit Task page');
        await AccountsOnePageHelper.clickMenuButton();
        StepLogger.verification('Menu should be displayed with History and Delete options');
        await AccountsOnePageHelper.verifyMenuList();

        StepLogger.stepId(4);
        StepLogger.step('Click on Delete button');
        await AccountsOnePageHelper.clickDelete(false);
        StepLogger.verification('Confirmation Message should be displayed "Are you sure you want to delete?"');
        await AccountsOnePageHelper.verifyConfirmWindow();

        StepLogger.stepId(5);
        StepLogger.step('Click Cancel');
        await AccountsOnePageHelper.clickConfirmWindowCancel();
        StepLogger.verification('Task should not get deleted and user should be in Edit Task page');
        await AccountsOnePageHelper.verifySubjectIsEntered(uniqueText);
    });

    // Jira References - COTRAC-2170
    it('Verify that User can Delete a selected Task of an Account - [22946687]', async () => {
        // Auto generated by aurea-automation - util on Tue, 09 Apr 2019 13:59:28 GMT

        StepLogger.caseId = 22946687;
        const uniqueText = await PageHelper.getUniqueId();

        StepLogger.preCondition('Log in and navigate to Production page and open an account ');
        await AccountsOnePageHelper.navigateAndCreatTask(uniqueText);

        StepLogger.stepId(1);
        StepLogger.step('Go to task tab from the left menu panel');
        await AccountsOnePageHelper.clickTasksTabInSidebar();
        StepLogger.verification('Tasks should be displayed in a grid view for the opened Account');
        await AccountsOnePageHelper.verifyTasksPageIsDisplayed();

        StepLogger.stepId(2);
        StepLogger.step('Click on edit icon before Task name for any Item in list');
        await AccountsOnePageHelper.clickEditTask(uniqueText);
        StepLogger.verification('Edit task page should be displayed for the selected task');
        await AccountsOnePageHelper.verifySubjectIsEntered(uniqueText);

        StepLogger.stepId(3);
        StepLogger.step('Click on the three dots at Top left corner of Edit Task page');
        await AccountsOnePageHelper.clickMenuButton();
        StepLogger.verification('Menu should be displayed with History and Delete options');
        await AccountsOnePageHelper.verifyMenuList();

        StepLogger.stepId(4);
        StepLogger.step('Click on Delete button');
        await AccountsOnePageHelper.clickDelete(false);
        StepLogger.verification('Confirmation Message should be displayed "Are you sure you want to delete?"');
        await AccountsOnePageHelper.verifyConfirmWindow();

        StepLogger.stepId(5);
        StepLogger.step('Click OK');
        await AccountsOnePageHelper.clickConfirmWindowOk();
        StepLogger.verification('Task should get deleted successfully and should not be displayed' +
            ' in the Tasks list for the selected Account');
        await AccountsOnePageHelper.verifyTaskIsDeletedUnderTaskQueue(uniqueText);
    });
});
