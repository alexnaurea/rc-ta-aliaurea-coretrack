import { StepLogger } from '../../../../../core/logger/step-logger';
import { PageHelper } from '../../../../components/html/page-helper';
import { CustomItemTypesConstants } from '../../../../page-objects/pages/administration/configuration/custom-item-types/custom-item-types.constants';
import { CustomItemTypesHelper } from '../../../../page-objects/pages/administration/configuration/custom-item-types/custom-item-types.helper';
import { CustomItemTypesPage } from '../../../../page-objects/pages/administration/configuration/custom-item-types/custom-item-types.po';
import { CommonPageHelper } from '../../../../page-objects/pages/common/common-page.helper';
import { HomePage } from '../../../../page-objects/pages/home-page/home-page.po';
import { LoginPageHelper } from '../../../../page-objects/pages/login-page/login-page.helper';
import { SuiteNames } from '../../../helpers/suite-names';

describe(SuiteNames.regressionSuite, () => {
    const itemTypeName = CustomItemTypesConstants.table.itemTypeName;
    let loginPageHelper: LoginPageHelper;

    beforeAll(async () => {
        loginPageHelper = LoginPageHelper.getInstance();
        await PageHelper.maximiseBrowser();
    });

    beforeEach(async () => {
        await loginPageHelper.goTo();
        await LoginPageHelper.loginAsAdmin();
    });

    // Jira References - COTRAC-163
    it('Verify if user shall be able to refresh the page clicking on Refresh button - [22444215]', async () => {
        // Auto generated by aurea-automation - util on Sat, 20 Apr 2019 02:49:39 GMT

        StepLogger.caseId = 22444215;
        StepLogger.stepId(1);
        StepLogger.step('Navigate to Administration --> Configuration --> Custom Item Types in the left side navigation pane');
        await CustomItemTypesHelper.navigateToAdministrationConfiguration();
        StepLogger.verification('The is navigated to Custom Item Types option.');
        await HomePage.configurationUnderAdministration.customItemType.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on Custom Item Types menu in left side Navigation Pane.');
        await CustomItemTypesHelper.clickCustomItemTypesAndSelectItem();
        StepLogger.verification('The Custom Item Types page is displayed in the right side pane.');
        await CustomItemTypesHelper.verifyCustomItemTypesPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on the refresh button on the top left side of the screen');
        await CustomItemTypesHelper.clickRefresh();
        StepLogger.verification('The screen is refreshed and data is updated accordingly.');
        await CustomItemTypesHelper.verifyCustomItemTypesPageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on Sign off button at the bottom in the left side Navigation Pane.');
        await CommonPageHelper.signOffApp();
        StepLogger.verification('The Login screen is displayed again.');
        await LoginPageHelper.verifyLoginPage();
    });

    // Jira References - COTRAC-163
    it('Verify user views options on Custom Item Types page. - [22444212]', async () => {
        // Auto generated by aurea-automation - util on Sat, 20 Apr 2019 02:49:39 GMT

        StepLogger.caseId = 22444212;
        StepLogger.stepId(1);
        StepLogger.step('Navigate to Administration --> Configuration --> Custom Item Types in the left side navigation pane');
        await CustomItemTypesHelper.navigateToAdministrationConfiguration();
        StepLogger.verification('The is navigated to Custom Item Types option.');
        await HomePage.configurationUnderAdministration.customItemType.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on Custom Item Types menu in left side Navigation Pane.');
        await CustomItemTypesHelper.clickCustomItemTypesAndSelectItem();
        StepLogger.verification('The Custom Item Types page is displayed in the right side pane.');
        await CustomItemTypesHelper.verifyCustomItemTypesPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Verify user views options on Custom Item Types page.');
        StepLogger.verification(`The user is able to view below options on Custom Item Types page:
            Refresh
            Add Custom Item Type
            Export to Excel
            Export to Word`);
        await CustomItemTypesHelper.verifyAllButtonDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on Sign off button at the bottom in the left side Navigation Pane.');
        await CommonPageHelper.signOffApp();
        StepLogger.verification('The Login screen is displayed again.');
        await LoginPageHelper.verifyLoginPage();
    });

    // Jira References - COTRAC-163
    it('Verify if user shall be able to see the header content properly - [22444211]', async () => {
        // Auto generated by aurea-automation - util on Sat, 20 Apr 2019 02:49:39 GMT

        StepLogger.caseId = 22444211;
        StepLogger.stepId(1);
        StepLogger.step('Navigate to Administration --> Configuration --> Custom Item Types in the left side navigation pane');
        await CustomItemTypesHelper.navigateToAdministrationConfiguration();
        StepLogger.verification('The is navigated to Custom Item Types option.');
        await HomePage.configurationUnderAdministration.customItemType.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on Custom Item Types menu in left side Navigation Pane.');
        await CustomItemTypesHelper.clickCustomItemTypesAndSelectItem();
        StepLogger.verification('The Custom Item Types page is displayed in the right side pane.');
        await CustomItemTypesHelper.verifyCustomItemTypesPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Verify the header content on Custom Item Types page.');
        StepLogger.verification('The Items are listed in Grid with Header "Manage Custom Item Types" and column headings [Item Type - Active]');
        await CustomItemTypesHelper.verifyPageTitleAndTableColumnsDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on Sign off button at the bottom in the left side Navigation Pane.');
        await CommonPageHelper.signOffApp();
        StepLogger.verification('The Login screen is displayed again.');
        await LoginPageHelper.verifyLoginPage();
    });

    // Jira References - COTRAC-163
    it('Verify if user is able to access the Custom Item Types page - [22444210]', async () => {
        // Auto generated by aurea-automation - util on Sat, 20 Apr 2019 02:49:39 GMT

        StepLogger.caseId = 22444210;
        StepLogger.stepId(1);
        StepLogger.step('Navigate to Administration --> Configuration --> Custom Item Types in the left side navigation pane');
        await CustomItemTypesHelper.navigateToAdministrationConfiguration();
        StepLogger.verification('The is navigated to Custom Item Types option.');
        await HomePage.configurationUnderAdministration.customItemType.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on Custom Item Types menu in left side Navigation Pane.');
        await CustomItemTypesHelper.clickCustomItemTypesAndSelectItem();
        StepLogger.verification('The Custom Item Types page is displayed in the right side pane.');
        await CustomItemTypesHelper.verifyCustomItemTypesPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on Sign off button at the bottom in the left side Navigation Pane.');
        await CommonPageHelper.signOffApp();
        StepLogger.verification('The Login screen is displayed again.');
        await LoginPageHelper.verifyLoginPage();
    });

    // Jira References - COTRAC-163
    it('Verify Save button functionality on Edit Custom Item Type window. - [22444222]', async () => {
        // Auto generated by aurea-automation - util on Sat, 20 Apr 2019 02:49:40 GMT

        StepLogger.caseId = 22444222;
        StepLogger.stepId(1);
        StepLogger.step('Navigate to Administration --> Configuration --> Custom Item Types in the left side navigation pane');
        await CustomItemTypesHelper.navigateToAdministrationConfiguration();
        StepLogger.verification('The is navigated to Custom Item Types option.');
        await HomePage.configurationUnderAdministration.customItemType.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on Custom Item Types menu in left side Navigation Pane.');
        await CustomItemTypesHelper.clickCustomItemTypesAndSelectItem();
        StepLogger.verification('The Custom Item Types page is displayed in the right side pane.');
        await CustomItemTypesHelper.verifyCustomItemTypesPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on edit button next to Item Type column to view and edit the Custom Item Type');
        await CustomItemTypesHelper.clickEditElement();
        StepLogger.verification(`The Edit Item Type page is displayed with Save and Cancel buttons and following fields :
            ITEM TYPE
            STATUS`);
        await CustomItemTypesHelper.verifyEditItemElementsDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Make any changes to the Status field.');
        await CustomItemTypesHelper.changeDataElementsInEdit();
        StepLogger.verification('The changes are displayed in the Status field');
        await CustomItemTypesHelper.verifyChangesEnteredInEdit();

        StepLogger.stepId(5);
        StepLogger.step('Click on Save button.');
        await CustomItemTypesHelper.clickSave();
        StepLogger.verification('The record is saved and the Edit Item Type window is closed.');
        await CustomItemTypesPage.editItem.editItemTypeTitle.verifyHiddenStatus();

        StepLogger.stepId(6);
        StepLogger.step('Click on the refresh button on Manage Custom Item Types page.');
        await CustomItemTypesHelper.clickRefresh();
        await CustomItemTypesHelper.clickOnUnselectedTableItemName(itemTypeName);
        StepLogger.verification('The changes made to the record are reflected on the Manage Custom Item Types page.');
        await CustomItemTypesHelper.verifyChangesDisplayedInTableItems(itemTypeName, true);

        StepLogger.stepId(7);
        // Applied in the postCondition
        StepLogger.step('Click on Sign off button at the bottom in the left side Navigation Pane.');
        StepLogger.verification('The Login screen is displayed again.');

        StepLogger.postCondition('Revert the changed data');
        await CustomItemTypesHelper.revertDataElementsInEdit();
    });

    // Jira References - COTRAC-163
    it('Verify if user is able to view the Custom Item Type - [22444219]', async () => {
        // Auto generated by aurea-automation - util on Sat, 20 Apr 2019 02:49:40 GMT

        StepLogger.caseId = 22444219;
        StepLogger.stepId(1);
        StepLogger.step('Navigate to Administration --> Configuration --> Custom Item Types in the left side navigation pane');
        await CustomItemTypesHelper.navigateToAdministrationConfiguration();
        StepLogger.verification('The is navigated to Custom Item Types option.');
        await HomePage.configurationUnderAdministration.customItemType.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on Custom Item Types menu in left side Navigation Pane.');
        await CustomItemTypesHelper.clickCustomItemTypesAndSelectItem();
        StepLogger.verification('The Custom Item Types page is displayed in the right side pane.');
        await CustomItemTypesHelper.verifyCustomItemTypesPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on edit button next to Item Type column to view and edit the Custom Item Type');
        await CustomItemTypesHelper.clickEditElement();
        StepLogger.verification(`The Edit Item Type page is displayed with Save and Cancel buttons and following fields :
            ITEM TYPE
            STATUS`);
        await CustomItemTypesHelper.verifyEditItemElementsDisplayed();
        await CustomItemTypesHelper.clickCancel();

        StepLogger.stepId(4);
        StepLogger.step('Click on Sign off button at the bottom in the left side Navigation Pane.');
        await CommonPageHelper.signOffApp();
        StepLogger.verification('The Login screen is displayed again.');
        await LoginPageHelper.verifyLoginPage();
    });

    // Jira References - COTRAC-163
    it('Verify if user is able to edit Status field on Edit Custom Item window - [22444221]', async () => {
        // Auto generated by aurea-automation - util on Sat, 20 Apr 2019 02:49:40 GMT

        StepLogger.caseId = 22444221;
        StepLogger.stepId(1);
        StepLogger.step('Navigate to Administration --> Configuration --> Custom Item Types in the left side navigation pane');
        await CustomItemTypesHelper.navigateToAdministrationConfiguration();
        StepLogger.verification('The is navigated to Custom Item Types option.');
        await HomePage.configurationUnderAdministration.customItemType.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on Custom Item Types menu in left side Navigation Pane.');
        await CustomItemTypesHelper.clickCustomItemTypesAndSelectItem();
        StepLogger.verification('The Custom Item Types page is displayed in the right side pane.');
        await CustomItemTypesHelper.verifyCustomItemTypesPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on edit button next to Item Type column to view and edit the Custom Item Type');
        await CustomItemTypesHelper.clickEditElement();
        StepLogger.verification(`The Edit Item Type page is displayed with Save and Cancel buttons and following fields :
            ITEM TYPE
            STATUS`);
        await CustomItemTypesHelper.verifyEditItemElementsDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Make changes to the Status field.');
        await CustomItemTypesHelper.changeDataElementsInEdit();
        StepLogger.verification('The changes are displayed in the Status field');
        await CustomItemTypesHelper.verifyChangesEnteredInEdit();

        StepLogger.stepId(5);
        StepLogger.step('Click on Save button.');
        await CustomItemTypesHelper.clickSave();
        StepLogger.verification('The record is saved and the Edit Item Type window is closed.');
        await CustomItemTypesPage.editItem.editItemTypeTitle.verifyHiddenStatus();

        StepLogger.stepId(6);
        StepLogger.step('Click on the refresh button on Manage Custom Item Types page.');
        await CustomItemTypesHelper.clickRefresh();
        await CustomItemTypesHelper.clickOnUnselectedTableItemName(itemTypeName);
        StepLogger.verification('The changes made to the record are reflected on the Manage Custom Item Types page.');
        await CustomItemTypesHelper.verifyChangesDisplayedInTableItems(itemTypeName, true);

        StepLogger.stepId(7);
        // Applied in the postCondition
        StepLogger.step('Click on Sign off button at the bottom in the left side Navigation Pane.');
        StepLogger.verification('The Login screen is displayed again.');

        StepLogger.postCondition('Revert the changed data');
        await CustomItemTypesHelper.revertDataElementsInEdit();
    });

    // Jira References - COTRAC-163
    it('Verify Add Custom Item Type button functionality on Custom Item Types page - [22444217]', async () => {
        // Auto generated by aurea-automation - util on Sat, 20 Apr 2019 02:49:40 GMT

        StepLogger.caseId = 22444217;
        StepLogger.stepId(1);
        StepLogger.step('Navigate to Administration --> Configuration --> Custom Item Types in the left side navigation pane');
        await CustomItemTypesHelper.navigateToAdministrationConfiguration();
        StepLogger.verification('The is navigated to Custom Item Types option.');
        await HomePage.configurationUnderAdministration.customItemType.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on Custom Item Types menu in left side Navigation Pane.');
        await CustomItemTypesHelper.clickCustomItemTypesAndSelectItem();
        StepLogger.verification('The Custom Item Types page is displayed in the right side pane.');
        await CustomItemTypesHelper.verifyCustomItemTypesPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on Add Custom Item Type button.');
        await CustomItemTypesHelper.clickOnAddItemTypes();
        StepLogger.verification(`The New Item window is displayed with Save and Cancel buttons and following fields:
            ITEM TYPE
            STATUS`);
        await CustomItemTypesHelper.verifyEditItemElementsDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on Close button (cross sign) on New Item window.');
        await CustomItemTypesHelper.clickClose();
        StepLogger.verification('The New Item window is closed and the main application is displayed again.');
        await CustomItemTypesHelper.verifyPageTitleAndTableColumnsDisplayed();

        StepLogger.stepId(5);
        StepLogger.step('Click on Sign off button at the bottom in the left side Navigation Pane.');
        await CommonPageHelper.signOffApp();
        StepLogger.verification('The Login screen is displayed again.');
        await LoginPageHelper.verifyLoginPage();
    });

    // Jira References - COTRAC-163
    it('Verify Cancel button functionality on Edit Custom Item Type window - [22444223]', async () => {
        // Auto generated by aurea-automation - util on Sat, 20 Apr 2019 02:49:40 GMT

        StepLogger.caseId = 22444223;
        StepLogger.stepId(1);
        StepLogger.step('Navigate to Administration --> Configuration --> Custom Item Types in the left side navigation pane');
        await CustomItemTypesHelper.navigateToAdministrationConfiguration();
        StepLogger.verification('The is navigated to Custom Item Types option.');
        await HomePage.configurationUnderAdministration.customItemType.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on Custom Item Types menu in left side Navigation Pane.');
        await CustomItemTypesHelper.clickCustomItemTypesAndSelectItem();
        StepLogger.verification('The Custom Item Types page is displayed in the right side pane.');
        await CustomItemTypesHelper.verifyCustomItemTypesPageDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on edit button next to Item Type column to view and edit the Custom Item Type');
        await CustomItemTypesHelper.clickEditElement();
        StepLogger.verification(`The Edit item Type page is displayed with Save and Cancel buttons and following fields :
            ITEM TYPE
            STATUS`);
        await CustomItemTypesHelper.verifyEditItemElementsDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Make desired changes to the status field.');
        await CustomItemTypesHelper.changeDataElementsInEdit();
        StepLogger.verification('The changes are displayed in the Status field.');
        await CustomItemTypesHelper.verifyChangesEnteredInEdit();

        StepLogger.stepId(5);
        StepLogger.step('Click on Cancel button on Edit window.');
        await CustomItemTypesHelper.clickCancel();
        StepLogger.verification('The record is not updated and the Edit window is closed.');
        await CustomItemTypesHelper.verifyChangesDisplayedInTableItems(itemTypeName);

        StepLogger.stepId(6);
        StepLogger.step('Click on Sign off button at the bottom in the left side Navigation Pane.');
        await CommonPageHelper.signOffApp();
        StepLogger.verification('The Login screen is displayed again.');
        await LoginPageHelper.verifyLoginPage();
    });
});
