import { StepLogger } from '../../../../core/logger/step-logger';
import { PageHelper } from '../../../components/html/page-helper';
import { WaitHelper } from '../../../components/html/wait-helper';
import { HomePageHelper } from '../../../page-objects/pages/home-page/home-page.helper';
import { HomePage } from '../../../page-objects/pages/home-page/home-page.po';
import { LoginPageHelper } from '../../../page-objects/pages/login-page/login-page.helper';
import { ToDoListPageHelper } from '../../../page-objects/pages/to-do-list/to-do-list-page.helper';
import { ToDoListPageConstant } from '../../../page-objects/pages/to-do-list/to-do-list.constants';

import { SuiteNames } from '../../helpers/suite-names';

describe(SuiteNames.regressionSuite, () => {
    const overdue = ToDoListPageConstant.overdue;
    let subjectName: string;
    let loginPageHelper: LoginPageHelper;

    beforeAll(async () => {
        loginPageHelper = LoginPageHelper.getInstance();
        await PageHelper.maximiseBrowser();
    });

    beforeEach(async () => {
        await PageHelper.restartBrowser();
        await loginPageHelper.goTo();
        await LoginPageHelper.loginAsAdmin();
        await WaitHelper.waitForPageToStable();
    });

    // Jira References - COTRAC-146
    it('Verify user is able to select option from My Activities dropdown. - [22965479]', async () => {
        // Auto generated by aurea-automation - util on Sun, 24 Mar 2019 14:32:30 GMT

        StepLogger.preCondition('Get data based on overdue');
        subjectName = await ToDoListPageHelper.createNewTaskAndGetInToDoList(
            ToDoListPageConstant.contactTabs.tasks);

        StepLogger.caseId = 22965479;
        StepLogger.stepId(1);
        // Covered in the precondition
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        await ToDoListPageHelper.getOverdueData(subjectName);
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Select any option from My Activities dropdown.');
        await ToDoListPageHelper.clickActivitiesArrow();
        await ToDoListPageHelper.clickOnItemInDdl(ToDoListPageConstant.activities.myActivities);
        StepLogger.verification('The records are displayed as per the option selected from the dropdown');
        await ToDoListPageHelper.verifyUsernameInActivityListDisplayed();
    });

    // Jira References - COTRAC-146
    it('Verify user is able to select "Due Today" option from Due"s dropdown. - [22965480]', async () => {
        // Auto generated by aurea-automation - util on Sun, 24 Mar 2019 14:32:30 GMT

        StepLogger.caseId = 22965480;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Select the "Due Today" option from Due"s dropdown.');
        await ToDoListPageHelper.clickOnOverdueArrow();
        StepLogger.verification('The records are displayed as per the "Due Today" option from Due"s dropdown.');
        await ToDoListPageHelper.verifyDisplayedItemInDdl(overdue.dueToday);
    });

    // Jira References - COTRAC-146
    it('Verify user is able to access To Do List page. - [22965475]', async () => {
        // Auto generated by aurea-automation - util on Sun, 24 Mar 2019 14:32:30 GMT

        StepLogger.caseId = 22965475;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Verify heading on To Do List page.');
        StepLogger.verification('The heading displayed on the page is "TO DO LIST"');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();
    });

    // Jira References - COTRAC-146
    it('Verify refresh button on To Do List page. - [22965849]', async () => {
        // Auto generated by aurea-automation - util on Sun, 24 Mar 2019 14:32:31 GMT

        StepLogger.caseId = 22965849;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on Refresh button.');
        await ToDoListPageHelper.clickOnRefresh();
        StepLogger.verification('The screen is refreshed and the data is updated accordingly.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();
    });

    // Jira References - COTRAC-146
    it('Verify user is able to select "Due Tomorrow" option from Due"s dropdown. - [22965818]', async () => {
        // Auto generated by aurea-automation - util on Sun, 24 Mar 2019 14:32:31 GMT

        StepLogger.caseId = 22965818;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Select the "Due Tomorrow" option from Due"s dropdown.');
        await ToDoListPageHelper.clickOnOverdueArrow();
        StepLogger.verification('The records are displayed as per the "Due Tomorrow" option from Due"s dropdown.');
        await ToDoListPageHelper.verifyDisplayedItemInDdl(overdue.dueTomorrow);
    });

    // Jira References - COTRAC-146
    it('Verify user is able to select "Overdue" option from Due"s dropdown. - [22965802]', async () => {
        // Auto generated by aurea-automation - util on Tue, 26 Mar 2019 19:07:44 GMT

        StepLogger.caseId = 22965802;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Select the "Overdue" option from Due"s dropdown.');
        await ToDoListPageHelper.clickOnOverdueArrow();
        StepLogger.verification('The records are displayed as per the "Overdue" option from Due"s dropdown.');
        await ToDoListPageHelper.verifyDisplayedItemInDdl(overdue.overdue);
    });

    // Jira References - COTRAC-146
    it('Verify user is able to select "Due This Week" option from Due"s dropdown. - [22965808]', async () => {
        // Auto generated by aurea-automation - util on Wed, 27 Mar 2019 11:59:37 GMT

        StepLogger.caseId = 22965808;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Select the "Due This Week" option from Due"s dropdown.');
        await ToDoListPageHelper.clickOnOverdueArrow();
        StepLogger.verification('The records are displayed as per the "Due This Week" option from Due"s dropdown.');
        await ToDoListPageHelper.verifyDisplayedItemInDdl(overdue.dueThisWeek);
    });

    // Jira References - COTRAC-146
    it('Verify user is able to view and edit the item from To Do List - [22967326]', async () => {
        // Auto generated by aurea-automation - util on Wed, 27 Mar 2019 12:00:42 GMT

        StepLogger.caseId = 22967326;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Edit button of the desired event.');
        await ToDoListPageHelper.getOverdueData(subjectName);
        await ToDoListPageHelper.clickEditButton();
        StepLogger.verification('The edit window is displayed with the Overview tab.');
        await ToDoListPageHelper.verifyEditPanelDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Make desired changes to the event.');
        StepLogger.verification('The changes can be seen in the respective fields.');
        subjectName = await ToDoListPageHelper.verifyCanEditSubjectTb();

        StepLogger.stepId(5);
        StepLogger.step('Click on Save button.');
        await ToDoListPageHelper.clickSaveEditEventLink();
        StepLogger.verification('The Edit window is closed and the updated record is displayed on the To Do List page.');
        await ToDoListPageHelper.verifySubjectNameInActivityListDisplayed(subjectName);
    });

    // Jira References - COTRAC-146
    it('Verify user is able to select "Completed Today" option from Due"s dropdown. - [22965844]', async () => {
        // Auto generated by aurea-automation - util on Wed, 27 Mar 2019 12:00:42 GMT

        StepLogger.caseId = 22965844;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Select the "Completed Today" option from Due"s dropdown.');
        await ToDoListPageHelper.clickOnOverdueArrow();
        StepLogger.verification('The records are displayed as per the "Completed Today" option from Due"s dropdown.');
        await ToDoListPageHelper.verifyDisplayedItemInDdl(overdue.completedToday);
    });

    // Jira References - COTRAC-146
    it('Verify user is able to select "Due Next Week" option from Due"s dropdown. - [22965838]', async () => {
        // Auto generated by aurea-automation - util on Wed, 27 Mar 2019 12:00:43 GMT

        StepLogger.caseId = 22965838;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Select the "Due Next Week" option from Due"s dropdown.');
        await ToDoListPageHelper.clickOnOverdueArrow();
        StepLogger.verification('The records are displayed as per the "Due Next Week" option from Due"s dropdown.');
        await ToDoListPageHelper.verifyDisplayedItemInDdl(overdue.dueNextWeek);
    });

    // Jira References - COTRAC-146
    it('Verify user is able to select "Completed This Week" option from Due"s dropdown. - [22965848]', async () => {
        // Auto generated by aurea-automation - util on Wed, 27 Mar 2019 12:00:43 GMT

        StepLogger.caseId = 22965848;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Select the "Completed This Week" option from Due"s dropdown.');
        await ToDoListPageHelper.clickOnOverdueArrow();
        StepLogger.verification('The records are displayed as per the "Completed This Week" option from Due"s dropdown.');
        await ToDoListPageHelper.verifyDisplayedItemInDdl(overdue.completedThisWeek);
    });

    // Jira References - COTRAC-146
    it('Verify user is able to select "Due This Month" option from Due"s dropdown. - [22965840]', async () => {
        // Auto generated by aurea-automation - util on Wed, 27 Mar 2019 12:00:43 GMT

        StepLogger.caseId = 22965840;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Select the "Due This Month" option from Due"s dropdown.');
        await ToDoListPageHelper.clickOnOverdueArrow();
        StepLogger.verification('The records are displayed as per the "Due This Month" option from Due"s dropdown.');
        await ToDoListPageHelper.verifyDisplayedItemInDdl(overdue.dueThisMonth);
    });

    // Jira References - COTRAC-146
    it('Verify user is able to search for an item on To Do List page. - [22967558]', async () => {
        // Auto generated by aurea-automation - util on Wed, 27 Mar 2019 12:03:13 GMT

        StepLogger.caseId = 22967558;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Enter some text in the search field to search for an item. For Example Enter "New"');
        await ToDoListPageHelper.getOverdueData(subjectName);
        StepLogger.verification('All the relevant records are displayed on the screen.');
        await ToDoListPageHelper.verifySubjectNameInActivityListDisplayed(subjectName);
    });

    // Jira References - COTRAC-146
    it('Verify user is able to cancel editing a To Do List record by clicking on x button. - [22967554]', async () => {
        // Auto generated by aurea-automation - util on Wed, 27 Mar 2019 12:03:14 GMT

        StepLogger.caseId = 22967554;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Edit button of the desired event.');
        await ToDoListPageHelper.getOverdueData(subjectName);
        await ToDoListPageHelper.clickEditButton();
        StepLogger.verification('The edit window is displayed with the Overview tab.');
        await ToDoListPageHelper.verifyEditPanelDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Make desired changes to the event.');
        StepLogger.verification('The changes can be seen in the respective fields.');
        const newSubjectName = await ToDoListPageHelper.verifyCanEditSubjectTb();

        StepLogger.stepId(5);
        StepLogger.step('Click on x button (cross sign) .');
        await ToDoListPageHelper.clickCloseIconInEdit();
        StepLogger.verification('The Edit window is closed and the record is not updated on the To Do List page.');
        await ToDoListPageHelper.verifySubjectNameInActivityListHidden(newSubjectName);
    });

    // Jira References - COTRAC-146
    it('Verify user is able to cancel editing a To Do List record by clicking on cancel button. - [22967548]', async () => {
        // Auto generated by aurea-automation - util on Wed, 27 Mar 2019 12:03:14 GMT

        StepLogger.caseId = 22967548;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Edit button of the desired event.');
        await ToDoListPageHelper.getOverdueData(subjectName);
        await ToDoListPageHelper.clickEditButton();
        StepLogger.verification('The edit window is displayed with the Overview tab.');
        await ToDoListPageHelper.verifyEditPanelDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Make desired changes to the event.');
        StepLogger.verification('The changes can be seen in the respective fields.');
        const newSubjectName = await ToDoListPageHelper.verifyCanEditSubjectTb();

        StepLogger.stepId(5);
        StepLogger.step('Click on Cancel button.');
        await ToDoListPageHelper.clickCancelIconInEdit();
        StepLogger.verification('The Edit window is closed and the record is not updated on the To Do List page.');
        await ToDoListPageHelper.verifySubjectNameInActivityListHidden(newSubjectName);
    });

    // Jira References - COTRAC-146
    it('Verify Add attachment button functionality on To Do List page. - [22967577]', async () => {
        // Auto generated by aurea-automation - util on Wed, 27 Mar 2019 12:03:14 GMT

        StepLogger.caseId = 22967577;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on Add attachment button next to desired record.');
        await ToDoListPageHelper.getOverdueData(subjectName);
        await ToDoListPageHelper.clickAttachmentTick();
        StepLogger.verification(`The Add attachment window is displayed with the following fields:
            Name
            Description
            File to Attach
            is Private`);
        await ToDoListPageHelper.verifyAttachmentSubWindowFields();
    });

    // Jira References - COTRAC-146
    it('Verify "Mark as complete" button functionality on To Do List page. - [22967564]', async () => {
        // Auto generated by aurea-automation - util on Wed, 27 Mar 2019 12:03:14 GMT

        StepLogger.caseId = 22967564;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is logged in to ResourceOne and homepage is displayed.');
        StepLogger.verification('The user is logged in to ResourceOne and homepage is displayed.');
        await HomePage.pageTitle.verifyDisplayedStatus();

        StepLogger.stepId(2);
        StepLogger.step('Click on To Do List button on the left side navigation pane.');
        await HomePageHelper.clickToDoListLabel();
        StepLogger.verification('To Do List page is displayed on right side pane.');
        await ToDoListPageHelper.verifyToDoListPageIsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on "Mark as complete" button next to any item.');
        await ToDoListPageHelper.getOverdueData(subjectName);
        await ToDoListPageHelper.verifyCanClickOccurredTick();
        StepLogger.verification('The record is removed from the list and moved to Completed This week list.');
        await ToDoListPageHelper.verifySubjectNameInActivityListHidden(subjectName);

        StepLogger.stepId(4);
        StepLogger.step('Filter Completed This week from the dropdown and verify if the record is present.');
        await ToDoListPageHelper.getCompletedData(subjectName);
        StepLogger.verification('The user can view the record on this page.');
        await ToDoListPageHelper.verifySubjectNameInActivityListDisplayed(subjectName);
    });
});
