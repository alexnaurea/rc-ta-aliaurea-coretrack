import { StepLogger } from '../../../../../core/logger/step-logger';
import { PageHelper } from '../../../../components/html/page-helper';
import { CaseAreasConstant } from '../../../../page-objects/pages/administration/service-center/case-areas-page/case-areas.constants';
import { CaseAreasHelper } from '../../../../page-objects/pages/administration/service-center/case-areas-page/case-areas.helper';
import { HomePageHelper } from '../../../../page-objects/pages/home-page/home-page.helper';
import { LoginPageHelper } from '../../../../page-objects/pages/login-page/login-page.helper';
import { SuiteNames } from '../../../helpers/suite-names';

describe(SuiteNames.regressionSuite, () => {
    let loginPageHelper: LoginPageHelper;
    const category = `${CaseAreasConstant.elementNames.test}${PageHelper.getUniqueId()}${PageHelper.getUniqueId()}`;
    const subCategory = `${CaseAreasConstant.elementNames.subcategory}${PageHelper.getUniqueId()}`;

    beforeAll(async () => {
        loginPageHelper = LoginPageHelper.getInstance();
        await PageHelper.maximiseBrowser();
    });

    beforeEach(async () => {
        await PageHelper.restartBrowser();
        await loginPageHelper.goTo();
        await LoginPageHelper.loginAsAdmin();
    });

    // Jira References - COTRAC-3242
    it('Verify that the user can navigate to Manage Case Areas page - [22934756]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Mar 2019 08:36:19 GMT
        StepLogger.caseId = 22934756;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Case Areas menu');
        await HomePageHelper.clickCaseAreasUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Case Areas page should be displayed');
        await CaseAreasHelper.verifyCaseAreasPageDisplayed();
    });

    // Jira References - COTRAC-3243
    it('Verify that the user can access New Category page - [22934780]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Mar 2019 08:55:36 GMT
        StepLogger.caseId = 22934780;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Case Areas menu');
        await HomePageHelper.clickCaseAreasUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Case Areas page should be displayed');
        await CaseAreasHelper.verifyCaseAreasPageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Category icon on the top left of the icon section');
        await CaseAreasHelper.clickAddCategoryButton(true);
        StepLogger.verification('New Category page should be displayed');
        await CaseAreasHelper.verifyCategoryDialog();
    });

    // Jira References - COTRAC-3244
    it('Verify attributes and buttons in New Category page - [22934784]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Mar 2019 09:16:21 GMT
        StepLogger.caseId = 22934784;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Case Areas menu');
        await HomePageHelper.clickCaseAreasUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Case Areas page should be displayed');
        await CaseAreasHelper.verifyCaseAreasPageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Category icon on the top left of the icon section');
        await CaseAreasHelper.clickAddCategoryButton(true);
        StepLogger.verification('New Category page should be displayed');
        await CaseAreasHelper.verifyCategoryDialog();

        StepLogger.stepId(5);
        StepLogger.step('Verify attributes in New Category page');
        StepLogger.verification(`Following mandatory attributes should be displayed,
            Category,
            Status (dropdown)`);
        await CaseAreasHelper.verifyCategoryDialogAttributes();

        StepLogger.stepId(6);
        StepLogger.step('Verify buttons in New Category page');
        StepLogger.verification(`Following buttons should be displayed in bottom right of the page
            - Save - Cancel`);
        await CaseAreasHelper.verifyCategoryDialogButtons();
    });

    // Jira References - COTRAC-3245
    it('Verify Validation message when user click save without adding Category Name - [22935580]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Mar 2019 09:30:33 GMT
        StepLogger.caseId = 22935580;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Case Areas menu');
        await HomePageHelper.clickCaseAreasUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Case Areas page should be displayed');
        await CaseAreasHelper.verifyCaseAreasPageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Category icon on the top left of the icon section');
        await CaseAreasHelper.clickAddCategoryButton(true);
        StepLogger.verification('New Category page should be displayed');
        await CaseAreasHelper.verifyCategoryDialog();

        StepLogger.stepId(5);
        StepLogger.step('Click Save button without adding values to any field');
        await CaseAreasHelper.clickSaveCategoryDialog(true);
        StepLogger.verification('Validation message should be displayed "Please enter a Category name."');
        await CaseAreasHelper.verifyEnterNameDialog();

        StepLogger.stepId(6);
        StepLogger.step('Click OK');
        await CaseAreasHelper.clickOkErrorDialog();
        StepLogger.verification('Validation message should get closed and New Category page should be displayed');
        await CaseAreasHelper.verifyDialogClosedAndNewCategory();
    });

    // Jira References - COTRAC-3232
    it('Verify that User can add a Category for Case successfully - [22934799]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Mar 2019 09:42:30 GMT
        StepLogger.caseId = 22934799;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Case Areas menu');
        await HomePageHelper.clickCaseAreasUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Case Areas page should be displayed');
        await CaseAreasHelper.verifyCaseAreasPageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Category icon on the top left of the icon section');
        await CaseAreasHelper.clickAddCategoryButton(true);
        StepLogger.verification('New Category page should be displayed');
        await CaseAreasHelper.verifyCategoryDialog();

        StepLogger.stepId(5);
        StepLogger.step('Enter details for Category');
        await CaseAreasHelper.enterCategoryName(category, true);
        StepLogger.verification('Entered details should be displayed');
        await CaseAreasHelper.verifyCategoryName(category);

        StepLogger.stepId(6);
        StepLogger.step('Select Status as Active from the drop down');
        await CaseAreasHelper.selectStatusOption(CaseAreasConstant.statusDropdown.active);
        StepLogger.verification('Status value should be selected as Active');
        await CaseAreasHelper.verifyStatusSelectedOption(CaseAreasConstant.statusDropdown.active);

        StepLogger.stepId(7);
        StepLogger.step('Click Save');
        await CaseAreasHelper.clickSaveCategoryDialog();
        StepLogger.verification('New Category page should get closed and Manage Case Areas page should be displayed');
        await CaseAreasHelper.verifyDialogClosedAndCaseAreas();
    });

    // Jira References - COTRAC-3246
    it('Verify that the user can access New Subcategory page - [22934843]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Mar 2019 09:59:55 GMT
        StepLogger.caseId = 22934843;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Case Areas menu');
        await HomePageHelper.clickCaseAreasUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Case Areas page should be displayed');
        await CaseAreasHelper.verifyCaseAreasPageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Subcategory icon from the top left icon section');
        await CaseAreasHelper.clickAddSubcategoryButton();
        StepLogger.verification('New Subcategory page should be displayed');
        await CaseAreasHelper.verifySubcategoryDialog();
    });

    // Jira References - COTRAC-3247
    it('Verify attributes and buttons in New Subcategory page - [22934846]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Mar 2019 10:10:01 GMT
        StepLogger.caseId = 22934846;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Case Areas menu');
        await HomePageHelper.clickCaseAreasUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Case Areas page should be displayed');
        await CaseAreasHelper.verifyCaseAreasPageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Subcategory icon from the top left icon section');
        await CaseAreasHelper.clickAddSubcategoryButton();
        StepLogger.verification('New Subcategory page should be displayed');
        await CaseAreasHelper.verifySubcategoryDialog();

        StepLogger.stepId(5);
        StepLogger.step('Verify mandatory and non mandatory attributes in New Subcategory page');
        StepLogger.verification(`Following mandatory attributes should be displayed marked with (*),
            Category (dropdown),
            Subcategory,
            Status,
            Following non mandatory attributes should be displayed,
            Default Queue,
            Private,
            Reminder`);
        await CaseAreasHelper.verifySubcategoryDialogAttributes();

        StepLogger.stepId(6);
        StepLogger.step('Verify buttons in New Subcategory page');
        StepLogger.verification(`Following buttons should be displayed in bottom right of the page
            - Save - Cancel`);
        await CaseAreasHelper.verifySubcategoryDialogButtons();
    });

    // Jira References - COTRAC-3237
    it('Verify Validation message when user click save without adding Subcategory Name - [22935593]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Mar 2019 10:29:58 GMT
        StepLogger.caseId = 22935593;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Case Areas menu');
        await HomePageHelper.clickCaseAreasUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Case Areas page should be displayed');
        await CaseAreasHelper.verifyCaseAreasPageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Subcategory icon from the top left icon section');
        await CaseAreasHelper.clickAddSubcategoryButton();
        StepLogger.verification('New Subcategory page should be displayed');
        await CaseAreasHelper.verifySubcategoryDialog();

        StepLogger.stepId(5);
        StepLogger.step('Click Save button without adding values to any field');
        await CaseAreasHelper.clickSaveSubcategoryDialog(true);
        StepLogger.verification('Validation message should be displayed "Please enter a SubCategory name."');
        await CaseAreasHelper.verifyEnterSubcategoryNameDialog();

        StepLogger.stepId(6);
        StepLogger.step('Click OK');
        await CaseAreasHelper.clickOkErrorDialog();
        StepLogger.verification('Validation message should get closed and New SubCategory page should be displayed');
        await CaseAreasHelper.verifyDialogClosedAndNewSubcategory();
    });

    // Jira References - COTRAC-3233
    it('Verify saved Category is successfully added via Subcategory page - [22934867]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Mar 2019 10:43:31 GMT
        StepLogger.caseId = 22934867;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Case Areas menu');
        await HomePageHelper.clickCaseAreasUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Case Areas page should be displayed');
        await CaseAreasHelper.verifyCaseAreasPageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Subcategory icon from the top left icon section');
        await CaseAreasHelper.clickAddSubcategoryButton();
        StepLogger.verification('New Subcategory page should be displayed');
        await CaseAreasHelper.verifySubcategoryDialog();

        StepLogger.stepId(5);
        StepLogger.step('Click on the Category drop down and verify Category saved in Precondition 3');
        await CaseAreasHelper.clickCategoryDropdown(true);
        StepLogger.verification('Saved category should be displayed in Category drop down');
        await CaseAreasHelper.verifySavedCategoryInDropdown(category, true, true);
    });

    // Jira References - COTRAC-3234
    it('Verify that User can add a Subcategory successfully - [22934888]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Mar 2019 11:19:44 GMT
        StepLogger.caseId = 22934888;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Case Areas menu');
        await HomePageHelper.clickCaseAreasUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Case Areas page should be displayed');
        await CaseAreasHelper.verifyCaseAreasPageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Subcategory icon from the top left icon section');
        await CaseAreasHelper.clickAddSubcategoryButton();
        StepLogger.verification('New Subcategory page should be displayed');
        await CaseAreasHelper.verifySubcategoryDialog();

        StepLogger.stepId(5);
        StepLogger.step('Click on the Category drop down and select Category saved in Precondition 3');
        await CaseAreasHelper.selectCategory(category, true);
        StepLogger.verification('Selected category should be displayed in Category drop down');
        await CaseAreasHelper.verifySelectedCategory(category);

        StepLogger.stepId(6);
        StepLogger.step('Enter details for Sub category');
        await CaseAreasHelper.enterSubcategoryName(subCategory);
        StepLogger.verification('Entered details should be displayed properly');
        await CaseAreasHelper.verifySubcategoryName(subCategory);

        StepLogger.stepId(7);
        StepLogger.step('Select Status as Active from the drop down');
        await CaseAreasHelper.selectStatusOptionSubcategory(CaseAreasConstant.statusDropdown.active);
        StepLogger.verification('Status value should be selected as Active');
        await CaseAreasHelper.verifyStatusSelectedOptionSubcategory(CaseAreasConstant.statusDropdown.active);

        StepLogger.stepId(8);
        StepLogger.step('Click Save');
        await CaseAreasHelper.clickSaveSubcategoryDialog();
        StepLogger.verification(`1. New Subcategory page should get closed
            2. Subcategory should get saved with the selected Category and displayed in the Manage Case Areas page`);
        await CaseAreasHelper.verifyDialogClosedAndSubcategoryCreated(category, subCategory);
    });
});
