import { StepLogger } from '../../../../../core/logger/step-logger';
import { PageHelper } from '../../../../components/html/page-helper';
import { KnowledgeBaseConstant } from '../../../../page-objects/pages/administration/service-center/knowledge-base/knowledge-base.constants';
import { KnowledgeBaseHelper } from '../../../../page-objects/pages/administration/service-center/knowledge-base/knowledge-base.helper';
import { HomePageHelper } from '../../../../page-objects/pages/home-page/home-page.helper';
import { LoginPageHelper } from '../../../../page-objects/pages/login-page/login-page.helper';
import { SuiteNames } from '../../../helpers/suite-names';

describe(SuiteNames.regressionSuite, () => {
    let loginPageHelper: LoginPageHelper;

    beforeAll(async () => {
        loginPageHelper = LoginPageHelper.getInstance();
        await PageHelper.maximiseBrowser();
    });

    beforeEach(async () => {
        await PageHelper.restartBrowser();
        await loginPageHelper.goTo();
        await LoginPageHelper.loginAsAdmin();
    });

    // Jira References - COTRAC-2719
    it('Verify that the user can navigate to Manage Knowledge Base page - [22426443]', async () => {
        // Auto generated by aurea-automation - util on Thu, 14 Mar 2019 09:03:49 GMT
        StepLogger.caseId = 22426443;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the to the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Knowledge Base menu');
        await HomePageHelper.clickKnowledgeBaseUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Knowledge Base page should be displayed as below');
        await KnowledgeBaseHelper.verifyKnowledgeBasePageDisplayed();
    });

    // Jira References - COTRAC-2720
    it('Verify that the user can access New Knowledge Base Article page - [22428492]', async () => {
        // Auto generated by aurea-automation - util on Thu, 14 Mar 2019 10:02:51 GMT
        StepLogger.caseId = 22428492;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the to the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Knowledge Base menu');
        await HomePageHelper.clickKnowledgeBaseUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Knowledge Base page should be displayed as below');
        await KnowledgeBaseHelper.verifyKnowledgeBasePageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Knowledge Base (Book icon) button on top left of the page');
        await KnowledgeBaseHelper.clickAddKnowledgeBaseButton();
        StepLogger.verification('New Knowledge Base Article page should be displayed');
        await KnowledgeBaseHelper.verifyKnowledgeBaseArticle();
    });

    // Jira References - COTRAC-2721
    it('Verify the attributes available on New Knowledge Base Article page - [22428499]', async () => {
        // Auto generated by aurea-automation - util on Thu, 14 Mar 2019 10:38:42 GMT
        StepLogger.caseId = 22428499;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the to the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Knowledge Base menu');
        await HomePageHelper.clickKnowledgeBaseUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Knowledge Base page should be displayed as below');
        await KnowledgeBaseHelper.verifyKnowledgeBasePageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Knowledge Base (Book icon) button on top left of the page');
        await KnowledgeBaseHelper.clickAddKnowledgeBaseButton();
        StepLogger.verification('New Knowledge Base Article page should be displayed');
        await KnowledgeBaseHelper.verifyKnowledgeBaseArticle();

        StepLogger.stepId(5);
        StepLogger.step('Verify the attributes available on New Knowledge Base Article page');
        StepLogger.verification(`New Knowledge Base Article page should contain,
            TITLE, DESCRIPTION, KEYWORDS, CATEGORY, STATUS, ACTIVE AND TEXT`);
        await KnowledgeBaseHelper.verifyBaseArticleAttributes();

        StepLogger.stepId(6);
        StepLogger.step('Click on Status dropdown');
        await KnowledgeBaseHelper.clickStatusDropdown(true);
        StepLogger.verification(`Following values should be available in Status dropdown
            "Pending" and "Approved"`);
        await KnowledgeBaseHelper.verifyStatusDropdownOptions();

        StepLogger.stepId(7);
        StepLogger.step('Click on Active dropdown');
        await KnowledgeBaseHelper.clickActiveDropdown(false);
        StepLogger.verification(`Following values should be available in Status dropdown
            "Inactive" and "Active"`);
        await KnowledgeBaseHelper.verifyActiveDropdownOptions();

        StepLogger.stepId(8);
        StepLogger.step('Verify the buttons available on New Knowledge Base Article page');
        StepLogger.verification(`New Knowledge Base Article page should contain,
            SAVE and CANCEL buttons`);
        await KnowledgeBaseHelper.verifyBaseArticleButtons();
    });

    // Jira References - COTRAC-2722
    it('Verify whether user can create new Knowledge Base without adding mandatory fields - [22428500]', async () => {
        // Auto generated by aurea-automation - util on Thu, 14 Mar 2019 11:52:53 GMT
        StepLogger.caseId = 22428500;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the to the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Knowledge Base menu');
        await HomePageHelper.clickKnowledgeBaseUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Knowledge Base page should be displayed as below');
        await KnowledgeBaseHelper.verifyKnowledgeBasePageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Knowledge Base (Book icon) button on top left of the page');
        await KnowledgeBaseHelper.clickAddKnowledgeBaseButton();
        StepLogger.verification('New Knowledge Base Article page should be displayed');
        await KnowledgeBaseHelper.verifyKnowledgeBaseArticle();

        StepLogger.stepId(5);
        StepLogger.step('Click Save button without adding any values to any field');
        await KnowledgeBaseHelper.clickArticleSaveButton(true);
        StepLogger.verification('Validation error message should be displayed "Please enter a Title"');
        await KnowledgeBaseHelper.verifyEnterTitleDialog();

        StepLogger.stepId(6);
        StepLogger.step('Click OK');
        await KnowledgeBaseHelper.clickOkErrorDialog();
        StepLogger.verification(`1. Validation error message should get closed
            2. New Knowledge Base Article page should be displayed`);
        await KnowledgeBaseHelper.verifyDialogClosedAndBaseArticle();
    });

    // Jira References - COTRAC-2733
    it('Verify whether user can Save new Knowledge Base without adding a Title - [22429588]', async () => {
        // Auto generated by aurea-automation - util on Thu, 14 Mar 2019 12:07:50 GMT
        StepLogger.caseId = 22429588;
        const name = `${KnowledgeBaseConstant.elementNames.test}${PageHelper.getUniqueId()}`;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the to the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Knowledge Base menu');
        await HomePageHelper.clickKnowledgeBaseUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Knowledge Base page should be displayed as below');
        await KnowledgeBaseHelper.verifyKnowledgeBasePageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Knowledge Base (Book icon) button on top left of the page');
        await KnowledgeBaseHelper.clickAddKnowledgeBaseButton();
        StepLogger.verification('New Knowledge Base Article page should be displayed');
        await KnowledgeBaseHelper.verifyKnowledgeBaseArticle();

        StepLogger.stepId(5);
        StepLogger.step('Enter values for DESCRIPTION, CATEGORY, STATUS and ACTIVE fields');
        const category = await KnowledgeBaseHelper.enterDescriptionCategoryStatusActive(name);
        StepLogger.verification('Entered values should be displayed');
        await KnowledgeBaseHelper.verifyDescriptionCategoryStatusActive(name, category);

        StepLogger.stepId(6);
        StepLogger.step('Click Save');
        await KnowledgeBaseHelper.clickArticleSaveButton(false);
        StepLogger.verification('Validation error message should be displayed "Please enter a Title"');
        await KnowledgeBaseHelper.verifyEnterTitleDialog();

        StepLogger.stepId(7);
        StepLogger.step('Click OK');
        await KnowledgeBaseHelper.clickOkErrorDialog();
        StepLogger.verification(`1. Validation error message should get closed
            2. New Knowledge Base Article page should be displayed`);
        await KnowledgeBaseHelper.verifyDialogClosedAndBaseArticle(name);
    });

    // Jira References - COTRAC-2724
    it('Verify whether user can Save new Knowledge Base without adding a Description - [22429608]', async () => {
        // Auto generated by aurea-automation - util on Thu, 14 Mar 2019 12:54:57 GMT
        StepLogger.caseId = 22429608;
        const name = `${KnowledgeBaseConstant.elementNames.test}${PageHelper.getUniqueId()}`;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the to the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Knowledge Base menu');
        await HomePageHelper.clickKnowledgeBaseUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Knowledge Base page should be displayed as below');
        await KnowledgeBaseHelper.verifyKnowledgeBasePageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Knowledge Base (Book icon) button on top left of the page');
        await KnowledgeBaseHelper.clickAddKnowledgeBaseButton();
        StepLogger.verification('New Knowledge Base Article page should be displayed');
        await KnowledgeBaseHelper.verifyKnowledgeBaseArticle();

        StepLogger.stepId(5);
        StepLogger.step('Enter values for TITLE, CATEGORY, STATUS and ACTIVE fields');
        const category = await KnowledgeBaseHelper.enterTitleCategoryStatusActive(name);
        StepLogger.verification('Entered values should be displayed');
        await KnowledgeBaseHelper.verifyTitleCategoryStatusActive(name, category);

        StepLogger.stepId(6);
        StepLogger.step('Click Save');
        await KnowledgeBaseHelper.clickArticleSaveButton(false);
        StepLogger.verification('Validation error message should be displayed "Please enter a Description"');
        await KnowledgeBaseHelper.verifyEnterDescriptionDialog();

        StepLogger.stepId(7);
        StepLogger.step('Click OK');
        await KnowledgeBaseHelper.clickOkErrorDialog();
        StepLogger.verification(`1. Validation error message should get closed
            2. New Knowledge Base Article page should be displayed with entered values`);
        await KnowledgeBaseHelper.verifyDialogClosedAndBaseArticle(name, true, false, true, true, true, category);
    });

    // Jira References - COTRAC-2727
    it('Verify whether user can Save new Knowledge Base without selecting a Category - [22429610]', async () => {
        // Auto generated by aurea-automation - util on Thu, 14 Mar 2019 13:55:52 GMT
        StepLogger.caseId = 22429610;
        const name = `${KnowledgeBaseConstant.elementNames.test}${PageHelper.getUniqueId()}`;

        StepLogger.stepId(1);
        StepLogger.step('Click Administration menu from the to the left menu panel');
        await HomePageHelper.clickAdministrationLink();
        StepLogger.verification('Administration menu should get expanded');
        await HomePageHelper.verifyOptionsUnderAdministration();

        StepLogger.stepId(2);
        StepLogger.step('Click Service Center menu under Administrator section');
        await HomePageHelper.clickServiceCenterUnderAdministration();
        StepLogger.verification('Service Center menu should get expanded');
        await HomePageHelper.verifyOptionsUnderServiceCenter();

        StepLogger.stepId(3);
        StepLogger.step('Click on the Knowledge Base menu');
        await HomePageHelper.clickKnowledgeBaseUnderServiceCenterUnderAdministration();
        StepLogger.verification('Manage Knowledge Base page should be displayed as below');
        await KnowledgeBaseHelper.verifyKnowledgeBasePageDisplayed();

        StepLogger.stepId(4);
        StepLogger.step('Click on the Add Knowledge Base (Book icon) button on top left of the page');
        await KnowledgeBaseHelper.clickAddKnowledgeBaseButton();
        StepLogger.verification('New Knowledge Base Article page should be displayed');
        await KnowledgeBaseHelper.verifyKnowledgeBaseArticle();

        StepLogger.stepId(5);
        StepLogger.step('Enter values for TITLE, DESCRIPTION, STATUS and ACTIVE fields');
        await KnowledgeBaseHelper.enterTitleDescriptionStatusActive(name);
        StepLogger.verification('Entered values should be displayed');
        await KnowledgeBaseHelper.verifyTitleDescriptionStatusActive(name);

        StepLogger.stepId(6);
        StepLogger.step('Click Save');
        await KnowledgeBaseHelper.clickArticleSaveButton(false);
        StepLogger.verification('Validation error message should be displayed "Please select a Category"');
        await KnowledgeBaseHelper.verifyEnterCategoryDialog();

        StepLogger.stepId(7);
        StepLogger.step('Click OK');
        await KnowledgeBaseHelper.clickOkErrorDialog();
        StepLogger.verification(`1. Validation error message should get closed
            2. New Knowledge Base Article page should be displayed with entered values`);
        await KnowledgeBaseHelper.verifyDialogClosedAndBaseArticle(name, true, true, false, true, true);
    });
});
